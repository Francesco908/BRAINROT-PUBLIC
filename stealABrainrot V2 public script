-- Admin vs Admin Script by Znfpro
-- Perfect Version with Advanced Anti-Cheat Bypass

wait(1)

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Wait for character properly
repeat wait() until player.Character
repeat wait() until player.Character:FindFirstChild("HumanoidRootPart")
repeat wait() until player.Character:FindFirstChild("Humanoid")

local character = player.Character
local humanoid = character.Humanoid
local rootPart = character.HumanoidRootPart

-- Variables
local basePosition = rootPart.Position
local stealActive = false
local speedBoostActive = false
local originalWalkSpeed = humanoid.WalkSpeed

-- Advanced Speed Coil Detection
local function findSpeedCoil()
    -- Check backpack
    local coil = player.Backpack:FindFirstChild("Speed Coil")
    if coil then return coil end
    
    -- Check character
    coil = character:FindFirstChild("Speed Coil")
    if coil then return coil end
    
    -- Check for variations
    for _, item in pairs(player.Backpack:GetChildren()) do
        if item.Name:lower():find("speed") and item:IsA("Tool") then
            return item
        end
    end
    
    return nil
end

-- Anti-Cheat Bypass System
local function bypassAntiCheat()
    -- Block speed resets
    local connection1 = humanoid:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
        if speedBoostActive and humanoid.WalkSpeed < 80 then
            humanoid.WalkSpeed = 80
        end
    end)
    
    -- Block position resets
    local connection2 = rootPart:GetPropertyChangedSignal("CFrame"):Connect(function()
        if stealActive then
            wait(0.1)
        end
    end)
    
    return {connection1, connection2}
end

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AdminVsAdminGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Startup message
local function showStartup()
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 300, 0, 100)
    frame.Position = UDim2.new(0.5, -150, 0.5, -50)
    frame.BackgroundColor3 = Color3.new(0, 0, 0)
    frame.BackgroundTransparency = 0.3
    frame.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 10)
    corner.Parent = frame
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = "Made by Znfpro"
    label.TextColor3 = Color3.new(1, 1, 1)
    label.TextScaled = true
    label.Font = Enum.Font.GothamBold
    label.Parent = frame
    
    -- Play music
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://76714680193450"
    sound.Volume = 0.5
    sound.Looped = true
    sound.Parent = workspace
    sound:Play()
    
    wait(3)
    frame:Destroy()
end

-- Notification function
local function notify(text, color)
    local notif = Instance.new("TextLabel")
    notif.Size = UDim2.new(0, 200, 0, 40)
    notif.Position = UDim2.new(0.5, -100, 0, 50)
    notif.BackgroundColor3 = color or Color3.new(0, 0, 0)
    notif.BackgroundTransparency = 0.2
    notif.Text = text
    notif.TextColor3 = Color3.new(1, 1, 1)
    notif.TextScaled = true
    notif.Font = Enum.Font.Gotham
    notif.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = notif
    
    game:GetService("Debris"):AddItem(notif, 2)
end

-- Create draggable button
local function createButton(text, pos, callback)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0, 150, 0, 50)
    button.Position = pos
    button.BackgroundColor3 = Color3.new(0, 0, 0)
    button.Text = text
    button.TextColor3 = Color3.new(1, 1, 1)
    button.TextScaled = true
    button.Font = Enum.Font.GothamBold
    button.Parent = screenGui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = button
    
    -- Simple dragging
    local dragging = false
    button.MouseButton1Down:Connect(function()
        dragging = true
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local mousePos = UserInputService:GetMouseLocation()
            button.Position = UDim2.new(0, mousePos.X - 75, 0, mousePos.Y - 25)
        end
    end)
    
    button.MouseButton1Click:Connect(callback)
    return button
end

-- Advanced Speed Boost System
local function toggleSpeedBoost()
    speedBoostActive = not speedBoostActive
    
    if speedBoostActive then
        local speedCoil = findSpeedCoil()
        if speedCoil then
            humanoid:EquipTool(speedCoil)
            notify("Speed Boost ON", Color3.new(0, 1, 0))
            
            -- Super speed
            humanoid.WalkSpeed = 80
            humanoid.JumpPower = 100
            
            -- Start bypass system
            local connections = bypassAntiCheat()
            
            -- Ultra advanced keeping system
            spawn(function()
                while speedBoostActive do
                    -- Force high speed
                    if humanoid.WalkSpeed < 80 then
                        humanoid.WalkSpeed = 80
                    end
                    if humanoid.JumpPower < 100 then
                        humanoid.JumpPower = 100
                    end
                    
                    -- Force equip Speed Coil
                    local currentTool = character:FindFirstChildOfClass("Tool")
                    if not currentTool or not currentTool.Name:lower():find("speed") then
                        local newCoil = findSpeedCoil()
                        if newCoil and newCoil.Parent ~= character then
                            humanoid:EquipTool(newCoil)
                        end
                    end
                    
                    -- Prevent dropping
                    for _, tool in pairs(character:GetChildren()) do
                        if tool:IsA("Tool") and tool.Name:lower():find("speed") then
                            tool.CanBeDropped = false
                            
                            -- Block all removal attempts
                            if tool.Parent ~= character then
                                tool.Parent = character
                            end
                        end
                    end
                    
                    wait(0.05) -- Very fast checking
                end
                
                -- Cleanup
                for _, connection in pairs(connections) do
                    connection:Disconnect()
                end
                humanoid.WalkSpeed = originalWalkSpeed
                humanoid.JumpPower = 50
            end)
        else
            notify("Speed Coil Not Found!", Color3.new(1, 0, 0))
            speedBoostActive = false
        end
    else
        notify("Speed Boost OFF", Color3.new(1, 1, 0))
        humanoid.WalkSpeed = originalWalkSpeed
        humanoid.JumpPower = 50
    end
end

-- Steal Rainbow function
local function stealRainbow()
    if stealActive then return end
    stealActive = true
    
    notify("Set Base", Color3.new(1, 1, 0))
    basePosition = rootPart.Position
    wait(1)
    
    notify("Steal!", Color3.new(0, 1, 0))
    
    -- Move backward fast
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.MaxForce = Vector3.new(4000, 0, 4000)
    bodyVelocity.Velocity = rootPart.CFrame.LookVector * -50
    bodyVelocity.Parent = rootPart
    
    wait(1)
    bodyVelocity:Destroy()
    
    -- Move to base with big jumps and normal walking
    spawn(function()
        while (rootPart.Position - basePosition).Magnitude > 8 do
            -- Big jump first
            local jumpVel = Instance.new("BodyVelocity")
            jumpVel.MaxForce = Vector3.new(0, math.huge, 0)
            jumpVel.Velocity = Vector3.new(0, 120, 0) -- Very big jump
            jumpVel.Parent = rootPart
            
            wait(0.5)
            jumpVel:Destroy()
            
            -- Normal walking speed toward base
            local direction = (basePosition - rootPart.Position).Unit
            local walkVel = Instance.new("BodyVelocity")
            walkVel.MaxForce = Vector3.new(4000, 0, 4000)
            walkVel.Velocity = Vector3.new(direction.X * 16, 0, direction.Z * 16) -- Normal walk speed
            walkVel.Parent = rootPart
            
            wait(2) -- Walk for 2 seconds
            walkVel:Destroy()
            wait(0.5) -- Small pause before next jump
        end
        
        notify("Steal Complete!", Color3.new(0, 1, 0))
        stealActive = false
    end)
end

-- Initialize everything
showStartup()

local stealButton = createButton("Steal Rainbow", UDim2.new(0, 50, 0, 200), stealRainbow)
local speedButton = createButton("Speed Boost", UDim2.new(0, 220, 0, 200), toggleSpeedBoost)

-- Update speed button color
spawn(function()
    while wait(0.1) do
        if speedButton then
            speedButton.BackgroundColor3 = speedBoostActive and Color3.new(0, 0.5, 0) or Color3.new(0, 0, 0)
        end
    end
end)

-- Handle respawn
player.CharacterAdded:Connect(function(newChar)
    repeat wait() until newChar:FindFirstChild("HumanoidRootPart")
    character = newChar
    humanoid = character.Humanoid
    rootPart = character.HumanoidRootPart
    originalWalkSpeed = humanoid.WalkSpeed
    stealActive = false
    speedBoostActive = false
end)
