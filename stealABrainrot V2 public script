-- LocalScript placed in StarterGui > ScreenGui

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AdminToolsGUI"
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Main draggable Frame
local frame = Instance.new("Frame")
frame.Name = "ToolFrame"
frame.Size = UDim2.new(0, 200, 0, 100)
frame.Position = UDim2.new(0.5, -100, 0.5, -50)
frame.BackgroundTransparency = 0.2
frame.BorderSizePixel = 0
frame.Active = true
frame.Parent = screenGui

-- Title label
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 24)
title.BackgroundTransparency = 1
title.Text = "Admin vs Admin"
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.SourceSansBold
title.TextSize = 18
title.Parent = frame

-- Instant Steal Button
local stealBtn = Instance.new("TextButton")
stealBtn.Name = "InstantSteal"
stealBtn.Size = UDim2.new(1, -10, 0, 32)
stealBtn.Position = UDim2.new(0, 5, 0, 30)
stealBtn.Text = "Fly to Base"
stealBtn.Font = Enum.Font.SourceSansBold
stealBtn.TextSize = 16
stealBtn.TextColor3 = Color3.new(0,0,0)
stealBtn.BorderSizePixel = 0
stealBtn.Parent = frame

-- Set Base Position Button
local baseBtn = Instance.new("TextButton")
baseBtn.Name = "SetBasePos"
baseBtn.Size = UDim2.new(1, -10, 0, 32)
baseBtn.Position = UDim2.new(0, 5, 0, 70)
baseBtn.Text = "Set Base Position"
baseBtn.Font = Enum.Font.SourceSansBold
baseBtn.TextSize = 16
baseBtn.TextColor3 = Color3.new(0,0,0)
baseBtn.BorderSizePixel = 0
baseBtn.Parent = frame

-- Rainbow effect
local hue = 0
RunService.RenderStepped:Connect(function(dt)
    hue = (hue + dt * 0.2) % 1
    local rainbow = Color3.fromHSV(hue, 1, 1)
    stealBtn.BackgroundColor3 = rainbow
    baseBtn.BackgroundColor3 = Color3.new(0,0,0):Lerp(rainbow, 0.5)
end)

-- Draggable frame
local dragging, dragInput, dragStart, startPos
local function updatePosition(input)
    local delta = input.Position - dragStart
    frame.Position = UDim2.new(
        startPos.X.Scale,
        startPos.X.Offset + delta.X,
        startPos.Y.Scale,
        startPos.Y.Offset + delta.Y
    )
end

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)

frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input == dragInput then updatePosition(input) end
end)

-- Advanced flight to base
local function flyToBase()
    local baseAttr = player:GetAttribute("BasePosition")
    if not baseAttr then
        warn("Base position not set.")
        return
    end
    -- parse stored Vector3 from string
    local coords = {}
    for num in baseAttr:gmatch("[-%d%.]+") do
        table.insert(coords, tonumber(num))
    end
    if #coords < 3 then return end
    local target = Vector3.new(coords[1], coords[2] + 30, coords[3])

    -- Create BodyVelocity and BodyGyro for smooth flight and rotation
    local bv = Instance.new("BodyVelocity")
    bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
    bv.Parent = hrp

    local bg = Instance.new("BodyGyro")
    bg.MaxTorque = Vector3.new(1e5, 1e5, 1e5)
    bg.P = 3000
    bg.D = 100
    bg.Parent = hrp

    -- Fly until close to target
    local connection
    connection = RunService.Heartbeat:Connect(function()
        local direction = (target - hrp.Position)
        bv.Velocity = direction.Unit * 100
        -- Set rotation to face movement
        bg.CFrame = CFrame.new(hrp.Position, target)
        if direction.Magnitude < 2 then
            -- Cleanup
            bv:Destroy()
            bg:Destroy()
            connection:Disconnect()
        end
    end)
end

-- Connect buttons
stealBtn.MouseButton1Click:Connect(flyToBase)
baseBtn.MouseButton1Click:Connect(function()
    -- Save current position
    player:SetAttribute("BasePosition", tostring(hrp.Position))
    print("Base position saved:", hrp.Position)
end)

print("Admin Tools GUI loaded.")
