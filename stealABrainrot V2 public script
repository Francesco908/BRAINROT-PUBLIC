-- Instant Steal GUI Script for Roblox
-- Advanced teleport and movement bypass system

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Variables for movement system
local isStealActive = false
local basePosition = nil
local movementConnection = nil
local floatPhase = "start"

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "InstantStealGUI"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

-- Main Frame (Draggable)
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Parent = screenGui
mainFrame.Size = UDim2.new(0, 280, 0, 160)
mainFrame.Position = UDim2.new(0.5, -140, 0.3, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true

-- Frame styling (hacker theme)
local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0, 8)
frameCorner.Parent = mainFrame

local frameStroke = Instance.new("UIStroke")
frameStroke.Color = Color3.fromRGB(0, 255, 150)
frameStroke.Thickness = 2
frameStroke.Parent = mainFrame

-- Glow effect
local glowFrame = Instance.new("Frame")
glowFrame.Name = "GlowFrame"
glowFrame.Parent = mainFrame
glowFrame.Size = UDim2.new(1, 6, 1, 6)
glowFrame.Position = UDim2.new(0, -3, 0, -3)
glowFrame.BackgroundColor3 = Color3.fromRGB(0, 255, 150)
glowFrame.BackgroundTransparency = 0.8
glowFrame.ZIndex = -1

local glowCorner = Instance.new("UICorner")
glowCorner.CornerRadius = UDim.new(0, 12)
glowCorner.Parent = glowFrame

-- Title
local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "TitleLabel"
titleLabel.Parent = mainFrame
titleLabel.Size = UDim2.new(1, 0, 0, 35)
titleLabel.Position = UDim2.new(0, 0, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "INSTANT STEAL"
titleLabel.TextColor3 = Color3.fromRGB(0, 255, 150)
titleLabel.TextScaled = true
titleLabel.Font = Enum.Font.Code
titleLabel.TextStrokeTransparency = 0
titleLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)

-- Status Label
local statusLabel = Instance.new("TextLabel")
statusLabel.Name = "StatusLabel"
statusLabel.Parent = mainFrame
statusLabel.Size = UDim2.new(1, -20, 0, 20)
statusLabel.Position = UDim2.new(0, 10, 0, 40)
statusLabel.BackgroundTransparency = 1
statusLabel.Text = "Status: READY"
statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
statusLabel.TextScaled = true
statusLabel.Font = Enum.Font.Code
statusLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Set Base Position Button
local setBaseBtn = Instance.new("TextButton")
setBaseBtn.Name = "SetBaseBtn"
setBaseBtn.Parent = mainFrame
setBaseBtn.Size = UDim2.new(1, -20, 0, 30)
setBaseBtn.Position = UDim2.new(0, 10, 0, 70)
setBaseBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
setBaseBtn.Text = "SET BASE POSITION"
setBaseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
setBaseBtn.TextScaled = true
setBaseBtn.Font = Enum.Font.Code
setBaseBtn.BorderSizePixel = 0

local setBaseBtnCorner = Instance.new("UICorner")
setBaseBtnCorner.CornerRadius = UDim.new(0, 5)
setBaseBtnCorner.Parent = setBaseBtn

local setBaseBtnStroke = Instance.new("UIStroke")
setBaseBtnStroke.Color = Color3.fromRGB(100, 100, 100)
setBaseBtnStroke.Thickness = 1
setBaseBtnStroke.Parent = setBaseBtn

-- Instant Steal Button
local stealBtn = Instance.new("TextButton")
stealBtn.Name = "StealBtn"
stealBtn.Parent = mainFrame
stealBtn.Size = UDim2.new(1, -20, 0, 35)
stealBtn.Position = UDim2.new(0, 10, 0, 110)
stealBtn.BackgroundColor3 = Color3.fromRGB(50, 20, 20)
stealBtn.Text = "INSTANT STEAL"
stealBtn.TextColor3 = Color3.fromRGB(255, 100, 100)
stealBtn.TextScaled = true
stealBtn.Font = Enum.Font.Code
stealBtn.BorderSizePixel = 0

local stealBtnCorner = Instance.new("UICorner")
stealBtnCorner.CornerRadius = UDim.new(0, 5)
stealBtnCorner.Parent = stealBtn

local stealBtnStroke = Instance.new("UIStroke")
stealBtnStroke.Color = Color3.fromRGB(255, 100, 100)
stealBtnStroke.Thickness = 2
stealBtnStroke.Parent = stealBtn

-- Button hover effects
local function createHoverEffect(button, hoverColor, normalColor)
    button.MouseEnter:Connect(function()
        local tween = TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = hoverColor})
        tween:Play()
    end)
    
    button.MouseLeave:Connect(function()
        local tween = TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = normalColor})
        tween:Play()
    end)
end

createHoverEffect(setBaseBtn, Color3.fromRGB(60, 60, 60), Color3.fromRGB(40, 40, 40))
createHoverEffect(stealBtn, Color3.fromRGB(80, 30, 30), Color3.fromRGB(50, 20, 20))

-- Advanced Float Teleport System
local floatPhase = "start" -- start, floating, descending, complete
local floatHeight = 175
local undergroundDepth = -70

local function advancedBypassMovement()
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChild("Humanoid")
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    
    if not humanoid or not rootPart or not basePosition then return end
    
    local currentPos = rootPart.Position
    local targetPos = basePosition
    
    -- Calculate horizontal distance (ignoring Y)
    local horizontalDistance = math.sqrt((targetPos.X - currentPos.X)^2 + (targetPos.Z - currentPos.Z)^2)
    
    if floatPhase == "start" then
        -- Phase 1: Teleport to 175 height
        local highPos = Vector3.new(currentPos.X, currentPos.Y + floatHeight, currentPos.Z)
        rootPart.CFrame = CFrame.new(highPos)
        floatPhase = "floating"
        humanoid.WalkSpeed = 30
        statusLabel.Text = "Status: FLOATING TO BASE"
        
    elseif floatPhase == "floating" then
        -- Phase 2: Float horizontally towards base maintaining 175 height
        local floatTargetPos = Vector3.new(targetPos.X, currentPos.Y, targetPos.Z)
        
        if horizontalDistance > 5 then
            -- Continue floating towards base
            local direction = (floatTargetPos - currentPos).Unit
            local newPos = currentPos + (direction * 2)
            -- Maintain exact height of 175
            newPos = Vector3.new(newPos.X, currentPos.Y, newPos.Z)
            rootPart.CFrame = CFrame.new(newPos)
        else
            -- Arrived at base horizontally, start descending
            floatPhase = "descending"
            statusLabel.Text = "Status: DESCENDING"
        end
        
    elseif floatPhase == "descending" then
        -- Phase 3: Teleport underground to -70
        local undergroundPos = Vector3.new(targetPos.X, undergroundDepth, targetPos.Z)
        rootPart.CFrame = CFrame.new(undergroundPos)
        floatPhase = "returning"
        statusLabel.Text = "Status: UNDERGROUND"
        
        -- Wait a moment then return to normal
        wait(0.5)
        floatPhase = "complete"
        
    elseif floatPhase == "returning" then
        -- Phase 4: Return to normal position
        local normalPos = Vector3.new(targetPos.X, targetPos.Y, targetPos.Z)
        rootPart.CFrame = CFrame.new(normalPos)
        floatPhase = "complete"
        
    elseif floatPhase == "complete" then
        -- Movement complete, stop everything
        isStealActive = false
        statusLabel.Text = "Status: STEAL COMPLETE"
        stealBtn.Text = "INSTANT STEAL"
        stealBtn.BackgroundColor3 = Color3.fromRGB(50, 20, 20)
        
        if movementConnection then
            movementConnection:Disconnect()
            movementConnection = nil
        end
        
        -- Reset player to normal
        humanoid.WalkSpeed = 16
        floatPhase = "start"
    end
end

-- Set Base Position Function
local function setBasePosition()
    local character = player.Character
    if not character then 
        statusLabel.Text = "Status: NO CHARACTER"
        return 
    end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then 
        statusLabel.Text = "Status: NO ROOT PART"
        return 
    end
    
    basePosition = rootPart.Position
    statusLabel.Text = "Status: BASE SET"
    
    -- Visual feedback
    local tween = TweenService:Create(setBaseBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(20, 80, 20)})
    tween:Play()
    
    wait(1)
    
    local tween2 = TweenService:Create(setBaseBtn, TweenInfo.new(0.3), {BackgroundColor3 = Color3.fromRGB(40, 40, 40)})
    tween2:Play()
end

-- Instant Steal Function
local function startInstantSteal()
    if not basePosition then
        statusLabel.Text = "Status: SET BASE FIRST"
        return
    end
    
    if isStealActive then
        -- Stop steal
        isStealActive = false
        statusLabel.Text = "Status: STOPPED"
        stealBtn.Text = "INSTANT STEAL"
        stealBtn.BackgroundColor3 = Color3.fromRGB(50, 20, 20)
        
        if movementConnection then
            movementConnection:Disconnect()
            movementConnection = nil
        end
        
        -- Reset player speed
        local character = player.Character
        if character then
            local humanoid = character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = 16
            end
        end
        
        floatPhase = "start"
        return
    end
    
    -- Start steal
    isStealActive = true
    floatPhase = "start"
    
    statusLabel.Text = "Status: STEALING..."
    stealBtn.Text = "STOP STEAL"
    stealBtn.BackgroundColor3 = Color3.fromRGB(80, 30, 30)
    
    -- Start movement loop
    movementConnection = RunService.Heartbeat:Connect(advancedBypassMovement)
end

-- Button connections
setBaseBtn.MouseButton1Click:Connect(setBasePosition)
stealBtn.MouseButton1Click:Connect(startInstantSteal)

-- Cleanup on player leaving
Players.PlayerRemoving:Connect(function(leavingPlayer)
    if leavingPlayer == player then
        if movementConnection then
            movementConnection:Disconnect()
        end
    end
end)

-- Glow animation
spawn(function()
    while wait(0.1) do
        if glowFrame and glowFrame.Parent then
            local tween = TweenService:Create(glowFrame, TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {BackgroundTransparency = 0.95})
            tween:Play()
        else
            break
        end
    end
end)

print("Instant Steal GUI loaded successfully!")
