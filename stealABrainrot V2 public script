-- Sigma Hub Universal Script
-- Made by Znfpro

-- Protezione base
if not game:IsLoaded() then
    game.Loaded:Wait()
end

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

-- Variabili globali
local basePosition = nil
local isMovingToBase = false
local gui = nil
local speedBoostEnabled = false
local jumpBoostEnabled = false

-- Attendi il personaggio
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local rootPart = character:WaitForChild("HumanoidRootPart")

-- Speed e Jump Boost permanenti
local function enablePermanentBoosts()
    speedBoostEnabled = true
    jumpBoostEnabled = true
    
    -- Loop permanente per mantenere speed e jump
    spawn(function()
        while true do
            if humanoid and humanoid.Parent then
                humanoid.WalkSpeed = 150  -- Velocità molto alta permanente
                humanoid.JumpPower = 120  -- Salto molto alto permanente
            end
            wait(0.1)
        end
    end)
end

-- Creazione GUI semplice
local function createGUI()
    -- Crea ScreenGui
    gui = Instance.new("ScreenGui")
    gui.Name = "SigmaHub"
    gui.Parent = player:WaitForChild("PlayerGui")
    
    -- Logo iniziale
    local logo = Instance.new("TextLabel")
    logo.Size = UDim2.new(0.4, 0, 0.1, 0)
    logo.Position = UDim2.new(0.3, 0, 0.3, 0)
    logo.BackgroundTransparency = 1
    logo.Text = "Made by Znfpro"
    logo.TextColor3 = Color3.new(1, 1, 1)
    logo.TextScaled = true
    logo.Font = Enum.Font.SourceSansBold
    logo.Parent = gui
    
    -- Fade in/out del logo
    for i = 1, 0, -0.1 do
        logo.TextTransparency = i
        wait(0.05)
    end
    
    wait(2)
    
    for i = 0, 1, 0.1 do
        logo.TextTransparency = i
        wait(0.05)
    end
    
    logo:Destroy()
    
    -- Crea pulsante principale
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0.15, 0, 0.08, 0)
    button.Position = UDim2.new(0.425, 0, 0.1, 0)
    button.BackgroundColor3 = Color3.new(0, 0, 0)
    button.Text = "Set Base"
    button.TextColor3 = Color3.new(1, 1, 1)
    button.TextScaled = true
    button.Font = Enum.Font.SourceSans
    button.Parent = gui
    
    -- Angoli arrotondati
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.3, 0)
    corner.Parent = button
    
    -- Drag functionality
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    button.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = button.Position
        end
    end)
    
    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            button.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    game:GetService("UserInputService").InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    -- Click functionality
    button.MouseButton1Click:Connect(function()
        if button.Text == "Set Base" then
            basePosition = rootPart.CFrame
            button.Text = "Go to Base"  -- Cambiato da "Steal Rainbow" a "Go to Base"
            
            -- Abilita speed e jump boost permanenti dopo aver settato la base
            enablePermanentBoosts()
            
            print("Base position saved! Speed & Jump Boost activated!")
        elseif button.Text == "Go to Base" then
            goToBase()  -- Rinominata la funzione
        end
    end)
end

-- God Mode semplice
local function enableGodMode()
    spawn(function()
        while isMovingToBase do
            if humanoid then
                humanoid.MaxHealth = math.huge
                humanoid.Health = humanoid.MaxHealth
            end
            wait(0.1)
        end
    end)
end

-- Funzione Go to Base (ex Steal Rainbow)
function goToBase()
    if not basePosition or isMovingToBase then return end
    
    isMovingToBase = true
    enableGodMode()
    
    -- Suono
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://76714680193450"
    sound.Volume = 0.5
    sound.Parent = workspace
    sound:Play()
    
    -- Movimento verso la base con salti alti
    spawn(function()
        while isMovingToBase do
            local distance = (basePosition.Position - rootPart.Position).Magnitude
            
            if distance < 5 then
                isMovingToBase = false
                rootPart.CFrame = basePosition
                print("Arrivato alla base!")
                sound:Destroy()
                break
            end
            
            -- Calcola direzione
            local direction = (basePosition.Position - rootPart.Position).Unit
            
            -- Movimento veloce (già settato a 150 permanentemente)
            humanoid:MoveTo(basePosition.Position)
            
            -- Salto automatico molto alto
            if humanoid.FloorMaterial ~= Enum.Material.Air then
                humanoid.Jump = true
                -- Aggiungi velocità extra verso l'alto per salti più alti
                rootPart.Velocity = Vector3.new(rootPart.Velocity.X, 150, rootPart.Velocity.Z)
                wait(0.3)  -- Ridotto il delay per salti più frequenti
            end
            
            wait(0.1)
        end
    end)
end

-- Anti-reset per mantenere speed e jump
spawn(function()
    while true do
        if humanoid and speedBoostEnabled then
            -- Forza i valori anche se qualcosa prova a cambiarli
            if humanoid.WalkSpeed < 150 then
                humanoid.WalkSpeed = 150
            end
            if humanoid.JumpPower < 120 then
                humanoid.JumpPower = 120
            end
        end
        wait(0.05)
    end
end)

-- Gestione respawn
player.CharacterAdded:Connect(function(newChar)
    character = newChar
    humanoid = newChar:WaitForChild("Humanoid")
    rootPart = newChar:WaitForChild("HumanoidRootPart")
    wait(1)
    createGUI()
    
    -- Riattiva boost se erano già attivi
    if speedBoostEnabled then
        enablePermanentBoosts()
    end
end)

-- Avvia GUI
createGUI()
print("Sigma Hub loaded successfully!")
